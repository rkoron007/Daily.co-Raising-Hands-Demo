<html>
  <head>
    <title>Hand Raising Demo</title>
    <!-- this library, bundled and minimized -->
    <script src="https://unpkg.com/@daily-co/daily-js"></script>
    <!-- <script src="./create-demo-room.js"></script> -->
    <!-- <script src="./hand-raise.js"></script> -->
  </head>
  <body>
    <div>
      <h2>Call Participants List:</h2>
      <ul id="participants-list">
        None
      </ul>
    </div>

    <p>
      <button onclick="createFrame()">
        Join the call!
      </button>
      <button id="raise-hand">
        Raise Your Hand
      </button>
    </p>

    <script>
      function showEvent(e) {
        console.log("video call event -->", e);
      }
      // update the list of users in the call and their hand state
      function updateParticipantList(e) {
        showEvent(e);
        const participantList = document.getElementById("participants-list");
        const participants = callFrame.participants();
        let listHtml = "";

        for (let id in participants) {
          let p = participants[id];
          listHtml += `
            <li>
              <p>${p.user_name || "guest"} - ${"âœ‹"}</p>
            </li>
          `;
        }
        participantList.innerHTML = listHtml;
      }

      async function createFrame() {
        callFrame = window.DailyIframe.createFrame({});

        callFrame
          .on("participant-joined", updateParticipantList)
          .on("participant-updated", updateParticipantList)
          .on("participant-left", updateParticipantList)
          .on("app-message", e => {
            console.log(data);
            debugger;
          })
          .on("error", showEvent);
        setUpRaiseHandBtn();
        //   .on("hand-raised", showEvent)
        //   .on("hand-lowered", showEvent)

        // join the room
        callFrame.join({ url: "https://rose-demo.daily.co/hello" });
      }

      function setUpRaiseHandBtn() {
        let raiseHandBtn = document.getElementById("raise-hand");
        raiseHandBtn.addEventListener("click", function(e) {
          callFrame.sendAppMessage({ data: "hello" });
        });
      }
    </script>
  </body>
</html>
